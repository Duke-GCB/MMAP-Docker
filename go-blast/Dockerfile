# BLAST+ container for gene ontology data
# Creates an NCBI BLAST+ database called go-seqdb in /blastdb
# Initial prototype for containerizing, but the gene identifier should conform to
# A standardized interface (e.g. https://github.com/bioboxes or http://nucleotid.es)
FROM phusion/baseimage
MAINTAINER Dan Leehr <dan.leehr@duke.edu>

# Install required libraries
RUN apt-get update && apt-get install -y \
  ncbi-blast+

# Originally had data in volume, but that doesn't really work when the data
# is generated by the image building, because the volume is initialized when
# the container starts.
# Rather, if we want a data-only container for the data, we should create
# a separate image with a shell script that updates the data

# Get data
ENV GO_SEQDB_URL http://archive.geneontology.org/lite/2015-02-14/go_20150214-seqdb.fasta.gz
# Download/extract to tmp
RUN curl -SL -o /tmp/go-seqdb.fasta.gz -SL $GO_SEQDB_URL
RUN gunzip /tmp/go-seqdb.fasta.gz
RUN mkdir /blastdb
RUN makeblastdb -in /tmp/go-seqdb.fasta -dbtype prot -parse_seqids -out /blastdb/go-seqdb
RUN rm /tmp/go-seqdb.fasta


